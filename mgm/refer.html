  <!DOCTYPE html>
  <html>
  <head>
    <title>Universal Link </title>
  </head>
  <body>
    <h1>MEMBER GET MEMBER</h1>
    <p><button class="js-getreferralCopied" id="copyAndRedirect">Get the app</button></p><br>
    <p><button class="js-downloadappbutton" id="goToAppStore">Download App</button></p>
    <a href="myapp://" target="_blank" id="urlschemelink">Go to app</a>
    <script>
        // Function to open the app or redirect to the store
        // Function to open the app or redirect to the store
      function getQueryParam(param) {
        //var urlParams = new URLSearchParams(window.location.search);
        //return urlParams.get(param);
        return window.location.href;
      }
      function openAppOrRedirect() {
        var userAgent = navigator.userAgent || navigator.vendor || window.opera;
          // Check if the device is iOS
          //if (/iPhone|iPad|iPod/i.test(userAgent)) {
            // Open the app using a custom URL scheme or redirect to the App Store
            // setTimeout(function() {
            //   window.location.href = "https://apps.apple.com/ae/app/cut-the-rope/id1024506959";
            // }, 2000);

            // alert("referralCode"+referralCode);
         // }
        //document.getElementById("copyAndRedirect").click();
      }

      function copyReferralToClipboard() {
        var downloadAppBtn = document.querySelector('.js-getreferralCopied');  
        downloadAppBtn.addEventListener('click', function(event) {  
          var referralCode = getQueryParam("referralcode"); 
          copyToClipboard(referralCode);
          document.getElementById("goToAppStore").click();
        });

      }

      function copyToClipboard(string) {
        let textarea;
        let result;

        try {
          textarea = document.createElement('textarea');
          textarea.setAttribute('readonly', true);
          textarea.setAttribute('contenteditable', true);
      textarea.style.position = 'fixed'; // prevent scroll from jumping to the bottom when focus is set.
      textarea.value = string;

      document.body.appendChild(textarea);

      textarea.focus();
      textarea.select();

      const range = document.createRange();
      range.selectNodeContents(textarea);

      const sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);

      textarea.setSelectionRange(0, textarea.value.length);
      result = document.execCommand('copy');
    } catch (err) {
      console.error(err);
      result = null;
    } finally {
      document.body.removeChild(textarea);
    }

    // manual copy fallback using prompt
    if (!result) {
      const isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;
      const copyHotkey = isMac ? 'âŒ˜C' : 'CTRL+C';
      result = prompt(`Press ${copyHotkey}`, string); // eslint-disable-line no-alert
      if (!result) {
        return false;
      }
    }
    return true;
  }
  function downloadAppFromAppStore() {
    var downloadAppBtn = document.querySelector('.js-downloadappbutton');  
    document.getElementById("goToAppStore").style.display="none";
    downloadAppBtn.addEventListener('click', function(event) {  
      window.location.href = "https://apps.apple.com/ae/app/cut-the-rope/id1024506959";
    });
  }

  function checkAppIsPresentAndRedirectToApp() {
    var referralCode = getQueryParam("referralcode");
    var a = document.getElementById('urlschemelink'); //or grab it by tagname etc
    a.href = "myapp://"+referralCode;
    document.getElementById('urlschemelink').click();
  }

        // Example referral code, replace with dynamic code as needed
        // var referralCode = "47bb9168-f7dc-4d23-9d09-f6030829da0f";
  downloadAppFromAppStore();
  copyReferralToClipboard();
  openAppOrRedirect();
  //checkAppIsPresentAndRedirectToApp();
</script>
</body>
</html>
